{"version":3,"sources":["webpack://ckeditor-axe/./src/frame.js"],"names":["window","addEventListener","event","origin","console","error","msg","data","command","CKEDITOR","parent","editor","instances","args","arguments","context","document","body","axe","run","options","results","tools","callFunction","callback"],"mappings":";;AAAA,CAAC,YAAW;AACV;AACF;AACA;AACEA,QAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmC,UAASC,KAAT,EAAgB;AACjD;AACA;AACA,QAAIF,MAAM,CAACG,MAAP,KAAkBD,KAAK,CAACC,MAA5B,EAAoC;AAClCC,aAAO,CAACC,KAAR,CAAc,4BAAd;AACA,aAAO,KAAP;AACD,KANgD,CAOjD;;;AACA,QAAIC,GAAG,GAAGJ,KAAK,CAACK,IAAhB;;AACA,QAAI,OAAOD,GAAG,CAACE,OAAX,KAAuB,WAA3B,EAAwC;AACtCJ,aAAO,CAACC,KAAR,CAAc,8BAAd;AACA,aAAO,KAAP;AACD,KAZgD,CAajD;;;AACA,QAAII,QAAQ,GAAGT,MAAM,CAACU,MAAP,CAAcD,QAA7B;;AACA,QACE,OAAOH,GAAG,CAACK,MAAX,KAAsB,WAAtB,IACA,OAAOF,QAAQ,CAACG,SAAT,CAAmBN,GAAG,CAACK,MAAvB,CAAP,KAA0C,WAF5C,EAGE;AACAP,aAAO,CAACC,KAAR,CAAc,6BAAd;AACA,aAAO,KAAP;AACD,KArBgD,CAuBjD;;;AACA,QAAIC,GAAG,CAACE,OAAJ,KAAgB,KAApB,EAA2B;AACzB,UAAIK,IAAI,GAAGP,GAAG,CAACQ,SAAf;AACA,UAAIC,OAAO,GAAGC,QAAQ,CAACC,IAAvB,CAFyB,CAGzB;;AACAF,aAAO,GAAG,OAAOF,IAAI,CAACE,OAAZ,KAAwB,WAAxB,GAAsCF,IAAI,CAACE,OAA3C,GAAqDA,OAA/D,CAJyB,CAKzB;;AACAG,SAAG,CAACC,GAAJ,CAAQJ,OAAR,EAAiBF,IAAI,CAACO,OAAtB,EAA+B,UAASf,KAAT,EAAgBgB,OAAhB,EAAyB;AACtDZ,gBAAQ,CAACa,KAAT,CAAeC,YAAf,CAA4BV,IAAI,CAACW,QAAjC,EAA2CnB,KAA3C,EAAkDgB,OAAlD,EAA2Df,GAAG,CAACK,MAA/D;AACD,OAFD;AAGD,KATD,MASO;AACLP,aAAO,CAACC,KAAR,CAAc,kBAAd;AACD;AACF,GApCD;AAqCD,CAzCD,I","file":"frame.js","sourcesContent":["(function() {\n  /**\n   * We will add a small even listener to get signal from parent window to execute aXe check.\n   */\n  window.addEventListener(\"message\", function(event) {\n    // @todo: We should do something to log this errors in parent window.\n    // Validate message for security.\n    if (window.origin !== event.origin) {\n      console.error(\"Insecure command detected.\");\n      return false;\n    }\n    // Validate incoming command.\n    let msg = event.data;\n    if (typeof msg.command === \"undefined\") {\n      console.error(\"Command type is not defined.\");\n      return false;\n    }\n    // Validate editor instance.\n    let CKEDITOR = window.parent.CKEDITOR;\n    if (\n      typeof msg.editor === \"undefined\" ||\n      typeof CKEDITOR.instances[msg.editor] === \"undefined\"\n    ) {\n      console.error(\"Editor instance is invalid.\");\n      return false;\n    }\n\n    // Execute command (at current moment we have only one type of commands \"run\").\n    if (msg.command === \"run\") {\n      let args = msg.arguments;\n      let context = document.body;\n      // We will allow developer to provide custom context if they want.\n      context = typeof args.context !== \"undefined\" ? args.context : context;\n      // Redirect execution to parent frame.\n      axe.run(context, args.options, function(error, results) {\n        CKEDITOR.tools.callFunction(args.callback, error, results, msg.editor);\n      });\n    } else {\n      console.error(\"Invalid command.\");\n    }\n  });\n})();\n"],"sourceRoot":""}